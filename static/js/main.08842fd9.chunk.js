(this["webpackJsonpepic-react"]=this["webpackJsonpepic-react"]||[]).push([[5],{102:function(e,t,n){},110:function(e,t,n){},112:function(e,t,n){"use strict";n.r(t);var r,o=n(0),i=n(24),c=n.n(i),a=(n(102),n(9)),s=n(34),l=n(35),u=n(3),p=l.a.footer(r||(r=Object(s.a)(["\n  padding: 10px 10px;\n  text-align: center;\n  font-size: 12px;\n  color: #aaa;\n"])));var b,f,j,h,O=function(){return Object(u.jsx)(p,{children:Object(u.jsx)("h1",{children:"Image Upload"})})},d=n(96),m=(n(97),n(79)),y=n.p+"static/media/logo.e711194f.svg",g=n(45),w=n(76),v=n(78);var x="flex flex-wrap flex-row justify-between md:items-center md:space-x-4 bg-white py-6 px-6 relative",U="block",k="h-6 md:h-8",P="inline-block md:hidden w-8 h-8 rounded bg-white text-blue-300 p-1",z="absolute md:relative top-16 left-0 md:top-0 z-20 md:flex flex-col md:flex-row md:space-x-6 font-semibold w-full md:w-auto bg-white shadow-md rounded-lg md:rounded-none md:shadow-none md:bg-transparent p-6 pt-0 md:p-0",F="block py-1 text-gray-600 hover:underline",C="text-blue-400",D=l.a.img(b||(b=Object(s.a)([""]))),N=Object(l.a)(g.b)(f||(f=Object(s.a)([""]))),S=l.a.div(j||(j=Object(s.a)([""]))),M=Object(l.a)(m.a)(h||(h=Object(s.a)(["\n  border-radius: 0.25rem;\n"]))),I=Object(v.a)((function(){var e=Object(a.f)(),t=Object(w.a)(),n=t.UserStore,r=t.AuthStore,i=Object(o.useState)(!1),c=Object(d.a)(i,2),s=c[0],l=c[1],p=function(e){l(!0===e||!s)};return window.addEventListener("resize",function(e,t){var n=null;return function(){var r=this,o=arguments;clearTimeout(n),n=setTimeout((function(){e.apply(r,o)}),t)}}((function(){document.documentElement.clientWidth<768&&p(!0)}),100)),Object(o.useEffect)((function(){p(!0)}),[]),Object(u.jsxs)("header",{className:x,children:[Object(u.jsx)("a",{className:U,onClick:function(){p(!0),e.push("/")},children:Object(u.jsx)(D,{className:k,src:y,alt:""})}),Object(u.jsx)("button",{id:"hamburger",className:P,onClick:p,children:Object(u.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:Object(u.jsx)("path",{fillRule:"evenodd",d:"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})})}),Object(u.jsxs)("nav",{className:"".concat(z," ").concat(s?"hidden":""),children:[Object(u.jsx)(N,{className:F,to:"/",activeClassName:C,exact:!0,onClick:function(){p(!0)},children:"\u9996\u9875"}),Object(u.jsx)(N,{className:F,to:"/history",activeClassName:C,onClick:function(){p(!0)},children:"\u4e0a\u4f20\u5386\u53f2"}),Object(u.jsx)(N,{className:F,to:"/about",activeClassName:C,onClick:function(){p(!0)},children:"\u5173\u4e8e\u6211"}),Object(u.jsx)(S,{children:n.currentUser?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("span",{className:"mr-1",children:n.currentUser.attributes.username}),Object(u.jsx)(M,{type:"primary",onClick:function(){r.logout(),console.log("\u7528\u6237\u6ce8\u9500"),e.push("/")},children:"\u6ce8\u9500"})]}):Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(M,{className:"mr-1",type:"primary",onClick:function(){console.log("\u8df3\u8f6c\u5230\u767b\u5f55\u9875\u9762"),p(!0),e.push("/login")},children:"\u767b\u5f55"}),Object(u.jsx)(M,{type:"primary",onClick:function(){console.log("\u8df3\u8f6c\u5230\u6ce8\u518c\u9875\u9762"),p(!0),e.push("/register")},children:"\u6ce8\u518c"})]})})]})]})}));var L=function(){return Object(u.jsx)("div",{children:"Loading..."})},H=Object(o.lazy)((function(){return Promise.all([n.e(0),n.e(2),n.e(4),n.e(9),n.e(12)]).then(n.bind(null,267))})),A=Object(o.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(4),n.e(8),n.e(11)]).then(n.bind(null,268))})),E=Object(o.lazy)((function(){return n.e(10).then(n.bind(null,264))})),J=Object(o.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(13)]).then(n.bind(null,265))})),K=Object(o.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(14)]).then(n.bind(null,266))}));var R=function(){return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(I,{}),Object(u.jsx)("main",{className:"py-6 px-6",children:Object(u.jsx)(o.Suspense,{fallback:Object(u.jsx)(L,{}),children:Object(u.jsxs)(a.c,{children:[Object(u.jsx)(a.a,{path:"/",exact:!0,component:H}),Object(u.jsx)(a.a,{path:"/history",exact:!0,component:A}),Object(u.jsx)(a.a,{path:"/about",exact:!0,component:E}),Object(u.jsx)(a.a,{path:"/login",exact:!0,component:J}),Object(u.jsx)(a.a,{path:"/register",exact:!0,component:K})]})})}),Object(u.jsx)(O,{})]})};n(110),n(111);c.a.render(Object(u.jsx)(g.a,{children:Object(u.jsx)(R,{})}),document.getElementById("root"))},76:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var r=n(0),o=(n(66),n(21)),i=n(18),c=n(30),a=n(31),s=n(6),l=(n(56),n(2)),u=n(25),p=n.n(u);p.a.init({appId:"XlO937XedHKgzxM3pXiJxi2p-gzGzoHsz",appKey:"hcHtM6kF4vSwdagKmaaCVe8s",serverURL:"https://xlo937xe.lc-cn-n1-shared.com"});var b,f,j=function(e,t){var n=new u.User;return n.setUsername(e),n.setPassword(t),new Promise((function(e,t){n.signUp().then((function(t){return e(t)}),(function(e){return t(e)}))}))},h=function(e,t){return new Promise((function(n,r){u.User.logIn(e,t).then((function(e){return n(e)}),(function(e){return r(e)}))}))},O=function(){u.User.logOut()},d=function(){return u.User.current()},m=function(e,t){var n=new p.a.Object("Image"),r=new p.a.File(t,e);return n.set("filename",t),n.set("owner",p.a.User.current()),n.set("url",r),new Promise((function(e,t){n.save().then((function(t){return e(t)}),(function(e){return t(e)}))}))},y=function(e){var t=e.page,n=void 0===t?0:t,r=e.limit,o=void 0===r?10:r,i=new p.a.Query("Image");return i.limit(o),i.skip(n*o),i.descending("createdAt"),i.equalTo("owner",p.a.User.current()),new Promise((function(e,t){i.find().then((function(t){return e(t)})).catch((function(e){return t(e)}))}))},g=new(b=function(){function e(){Object(c.a)(this,e),Object(i.a)(this,"currentUser",f,this),Object(l.m)(this)}return Object(a.a)(e,[{key:"pullUser",value:function(){this.currentUser=d()}},{key:"resetUser",value:function(){this.currentUser=null}}]),e}(),f=Object(s.a)(b.prototype,"currentUser",[l.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Object(s.a)(b.prototype,"pullUser",[l.f],Object.getOwnPropertyDescriptor(b.prototype,"pullUser"),b.prototype),Object(s.a)(b.prototype,"resetUser",[l.f],Object.getOwnPropertyDescriptor(b.prototype,"resetUser"),b.prototype),b);g.pullUser();var w,v,x,U,k,P,z,F,C,D,N,S,M=g,I=new(w=function(){function e(){Object(c.a)(this,e),Object(i.a)(this,"filename",v,this),Object(i.a)(this,"file",x,this),Object(i.a)(this,"serverFile",U,this),Object(i.a)(this,"isUploading",k,this),Object(l.m)(this)}return Object(a.a)(e,[{key:"setFilename",value:function(e){this.filename=e}},{key:"setFile",value:function(e){this.file=e}},{key:"upload",value:function(){var e=this;return this.isUploading=!0,this.serverFile=null,new Promise((function(t,n){m(e.file,e.filename).then((function(n){e.serverFile=n,t(n)})).catch((function(e){o.b.error("\u4e0a\u4f20\u5931\u8d25"),n(e)})).finally((function(){return e.isUploading=!1}))}))}},{key:"reset",value:function(){this.isUploading=!1,this.serverFile=null}}]),e}(),v=Object(s.a)(w.prototype,"filename",[l.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),x=Object(s.a)(w.prototype,"file",[l.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=Object(s.a)(w.prototype,"serverFile",[l.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=Object(s.a)(w.prototype,"isUploading",[l.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(s.a)(w.prototype,"setFilename",[l.f],Object.getOwnPropertyDescriptor(w.prototype,"setFilename"),w.prototype),Object(s.a)(w.prototype,"setFile",[l.f],Object.getOwnPropertyDescriptor(w.prototype,"setFile"),w.prototype),Object(s.a)(w.prototype,"upload",[l.f],Object.getOwnPropertyDescriptor(w.prototype,"upload"),w.prototype),Object(s.a)(w.prototype,"reset",[l.f],Object.getOwnPropertyDescriptor(w.prototype,"reset"),w.prototype),w),L=new(P=function(){function e(){Object(c.a)(this,e),Object(i.a)(this,"list",z,this),Object(i.a)(this,"isLoading",F,this),Object(i.a)(this,"hasMore",C,this),Object(i.a)(this,"page",D,this),this.limit=10,Object(l.m)(this)}return Object(a.a)(e,[{key:"append",value:function(e){this.list=this.list.concat(e)}},{key:"find",value:function(){var e=this;this.isLoading=!0,console.log("find..."),y({page:this.page,limit:this.limit}).then((function(t){e.append(t),e.page++,t.length<e.limit&&(e.hasMore=!1)})).catch((function(e){o.b.error("\u52a0\u8f7d\u6570\u636e\u5931\u8d25",e)})).finally((function(){e.isLoading=!1}))}},{key:"reset",value:function(){this.list=[],this.isLoading=!1,this.hasMore=!0,this.page=0}}]),e}(),z=Object(s.a)(P.prototype,"list",[l.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=Object(s.a)(P.prototype,"isLoading",[l.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),C=Object(s.a)(P.prototype,"hasMore",[l.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),D=Object(s.a)(P.prototype,"page",[l.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Object(s.a)(P.prototype,"append",[l.f],Object.getOwnPropertyDescriptor(P.prototype,"append"),P.prototype),Object(s.a)(P.prototype,"find",[l.f],Object.getOwnPropertyDescriptor(P.prototype,"find"),P.prototype),Object(s.a)(P.prototype,"reset",[l.f],Object.getOwnPropertyDescriptor(P.prototype,"reset"),P.prototype),P);window.x=M;var H=new(N=function(){function e(){Object(c.a)(this,e),Object(i.a)(this,"values",S,this),Object(l.m)(this)}return Object(a.a)(e,[{key:"setUsername",value:function(e){this.values.username=e}},{key:"setPassword",value:function(e){this.values.password=e}},{key:"login",value:function(){console.log("\u767b\u5f55\u4e2d...");var e=this.values,t=e.username,n=e.password;return new Promise((function(e,r){h(t,n).then((function(t){o.b.success("\u767b\u5f55\u6210\u529f"),M.pullUser(),e(t)})).catch((function(e){o.b.error("\u767b\u5f55\u5931\u8d25"),M.resetUser(),r(e)}))}))}},{key:"logout",value:function(){o.b.success("\u6ce8\u9500\u6210\u529f"),O(),I.reset(),M.resetUser(),L.reset()}},{key:"register",value:function(){console.log("\u6ce8\u518c\u4e2d...");var e=this.values,t=e.username,n=e.password;return new Promise((function(e,r){j(t,n).then((function(t){o.b.success("\u6ce8\u518c\u6210\u529f"),M.pullUser(),e(t)})).catch((function(e){o.b.error("\u6ce8\u518c\u5931\u8d25"),M.resetUser(),r(e)}))}))}}]),e}(),S=Object(s.a)(N.prototype,"values",[l.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{username:"",password:""}}}),Object(s.a)(N.prototype,"setUsername",[l.f],Object.getOwnPropertyDescriptor(N.prototype,"setUsername"),N.prototype),Object(s.a)(N.prototype,"setPassword",[l.f],Object.getOwnPropertyDescriptor(N.prototype,"setPassword"),N.prototype),Object(s.a)(N.prototype,"login",[l.f],Object.getOwnPropertyDescriptor(N.prototype,"login"),N.prototype),Object(s.a)(N.prototype,"logout",[l.f],Object.getOwnPropertyDescriptor(N.prototype,"logout"),N.prototype),Object(s.a)(N.prototype,"register",[l.f],Object.getOwnPropertyDescriptor(N.prototype,"register"),N.prototype),N);window.b=M;var A=Object(r.createContext)({AuthStore:H,UserStore:M,ImageStore:I,HistoryStore:L});window.stores={AuthStore:H,UserStore:M,ImageStore:I};var E=function(){return Object(r.useContext)(A)}}},[[112,6,7]]]);
//# sourceMappingURL=main.08842fd9.chunk.js.map