{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Dragger","Result","styled","div","H1","h1","Image","Zmage","StyledInput","input","UploadIconContainer","p","Component","useStores","ImageStore","UserStore","props","showUploadList","beforeUpload","file","setFile","setFilename","name","currentUser","message","warning","test","type","size","error","upload","then","serverFile","console","log","catch","err","ref1","useRef","ref2","store","useLocalObservable","width","setWidth","height","setHeight","attributes","url","widthStr","heightStr","bindWidthChange","current","value","trim","bindHeightChange","tip","spinning","isUploading","className","InboxOutlined","target","href","rel","filename","src","alt","onChange","ref","placeholder","fullStr","Tips","observer","children","Home","Uploader"],"mappings":"sRAUQA,E,IAAAA,QAEFC,EAASC,IAAOC,IAAV,+FAMNC,EAAKF,IAAOG,GAAV,0FAMFC,EAAQJ,YAAOK,IAAPL,CAAH,+CAILM,EAAcN,IAAOO,MAAV,0LAWXC,EAAsBR,IAAOS,EAAV,8DAuJVC,EAjJG,WAAO,IAAD,EACYC,cAA1BC,EADc,EACdA,WAAYC,EADE,EACFA,UAEdC,EAAQ,CACZC,gBAAgB,EAChBC,aAAc,SAACC,GAGb,OAFAL,EAAWM,QAAQD,GACnBL,EAAWO,YAAYF,EAAKG,MACE,OAA1BP,EAAUQ,aACZC,EAAA,EAAQC,QAAQ,qEAAe,IACxB,GAGJ,wCAAwCC,KAAKP,EAAKQ,MAMnDR,EAAKS,KAAO,SACdJ,EAAA,EAAQK,MAAM,sCACP,IAETf,EAAWgB,SACRC,MAAK,SAACC,GACLC,QAAQC,IAAI,+BAEbC,OAAM,SAACC,GACNH,QAAQC,IAAI,4BACZD,QAAQC,IAAIE,OAET,IAjBLZ,EAAA,EAAQK,MAAM,4EACP,KAoBPQ,EAAOC,mBACPC,EAAOD,mBAGPE,EAAQC,aAAmB,iBAAO,CACtCC,MAAO,GACPC,SAFsC,SAE7BD,GACPF,EAAME,MAAQA,GAEhB,eACE,OAAOF,EAAME,MAAN,aAAoBF,EAAME,OAAU,IAE7CE,OAAQ,GACRC,UATsC,SAS5BD,GACRJ,EAAMI,OAASA,GAEjB,gBACE,OAAOJ,EAAMI,OAAN,aAAqBJ,EAAMI,QAAW,IAE/C,cACE,OACE9B,EAAWkB,WAAWc,WAAWC,IAAID,WAAWC,IAChD,gBACAP,EAAMQ,SACNR,EAAMS,eAINC,EAAkB,WACtBV,EAAMG,SAASN,EAAKc,QAAQC,MAAMC,SAG9BC,EAAmB,WACvBd,EAAMK,UAAUN,EAAKY,QAAQC,MAAMC,SAErC,OACE,cAAC,IAAD,UACG,WACC,OACE,gCACE,mBAAME,IAAI,qBAAMC,SAAU1C,EAAW2C,YAArC,SACE,eAACzD,EAAD,2BAAagB,GAAb,cACE,cAACN,EAAD,CAAqBgD,UAAU,uBAA/B,SACE,cAACC,EAAA,EAAD,MAEF,mBAAGD,UAAU,kBAAb,oEACA,mBAAGA,UAAU,uBAAb,8JAMH5C,EAAWkB,WACV,eAAC/B,EAAD,WACE,cAACG,EAAD,uCACA,+BACE,0DACA,6BACE,mBACEwD,OAAO,SACPC,KAAM/C,EAAWkB,WAAWc,WAAWC,IAAID,WAAWC,IACtDe,IAAI,sBAHN,SAKGhD,EAAWkB,WAAWc,WAAWC,IAAID,WAAWC,QAGrD,oDACA,6BAAKjC,EAAWiD,WAChB,0DACA,6BACE,cAACzD,EAAD,CACE0D,IAAKlD,EAAWkB,WAAWc,WAAWC,IAAID,WAAWC,IACrDkB,IAAI,OAGR,0DACA,+BACE,cAACzD,EAAD,CACEmB,KAAK,OACLuC,SAAUhB,EACViB,IAAK9B,EACL+B,YAAY,qDAEd,cAAC5D,EAAD,CACEkD,UAAU,SACV/B,KAAK,OACLuC,SAAUZ,EACVa,IAAK5B,EACL6B,YAAY,wDAGhB,6BACE,mBACER,OAAO,SACPC,KAAMrB,EAAM6B,QACZP,IAAI,sBAHN,SAKGtB,EAAM6B,kBAKb,YCjLVC,EAAOpE,IAAOC,IAAV,sIAaKS,EALG2D,aAAS,YAAmB,IAAhBC,EAAe,EAAfA,SACpBzD,EAAcF,cAAdE,UACR,OAAO,mCAAGA,EAAUQ,YAAc,KAAO,cAAC+C,EAAD,UAAOE,SCV5CC,EAAOF,aAAS,WACpB,OACE,qCACE,cAAC,EAAD,2EACA,cAACG,EAAD,UAKSD","file":"static/js/12.ed508d95.chunk.js","sourcesContent":["import React, { useRef } from \"react\";\nimport { useStores } from \"../stores\";\nimport { Observer, useLocalObservable } from \"mobx-react\";\n\nimport { Upload, message, Spin } from \"antd\";\nimport { InboxOutlined } from \"@ant-design/icons\";\n\nimport styled from \"styled-components\";\nimport Zmage from 'react-zmage'\n\nconst { Dragger } = Upload;\n\nconst Result = styled.div`\n  padding: 20px;\n  margin-top: 30px;\n  border: 1px dashed #ccc;\n`;\n\nconst H1 = styled.h1`\n  margin: 20px 0;\n  text-align: center;\n  font-size: 16px;\n`;\n\nconst Image = styled(Zmage)`\n  max-width: 30%;\n`;\n\nconst StyledInput = styled.input`\n  outline-style: none;\n  border: 1px solid #ccc;\n  border-radius: 3px;\n  padding: 2px 4px;\n  &:focus {\n    border-color: #66afe9;\n    outline: 0;\n  }\n`;\n\nconst UploadIconContainer = styled.p`\n  svg {\n    fill: #91d5ff;\n  }\n`\n\nconst Component = () => {\n  const { ImageStore, UserStore } = useStores();\n\n  const props = {\n    showUploadList: false,\n    beforeUpload: (file) => {\n      ImageStore.setFile(file);\n      ImageStore.setFilename(file.name);\n      if (UserStore.currentUser === null) {\n        message.warning(\"请先登录再上传，谢谢！\", 3);\n        return false;\n      }\n      // 判断图片类型\n      if (!/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/gi.test(file.type)) {\n        message.error(\"只能上传 png/svg/jpg/gif 格式的图片\");\n        return false;\n      }\n\n      // 判断图片大小\n      if (file.size > 1024 * 1024) {\n        message.error(\"图片最大为 1M\");\n        return false;\n      }\n      ImageStore.upload()\n        .then((serverFile) => {\n          console.log(\"上传成功\");\n        })\n        .catch((err) => {\n          console.log(\"上传失败\");\n          console.log(err);\n        });\n      return false;\n    },\n  };\n\n  const ref1 = useRef();\n  const ref2 = useRef();\n\n  // 使用 mobx-react-lite 定义本地数据\n  const store = useLocalObservable(() => ({\n    width: \"\",\n    setWidth(width) {\n      store.width = width;\n    },\n    get widthStr() {\n      return store.width ? `/w/${store.width}` : \"\";\n    },\n    height: \"\",\n    setHeight(height) {\n      store.height = height;\n    },\n    get heightStr() {\n      return store.height ? `/h/${store.height}` : \"\";\n    },\n    get fullStr() {\n      return (\n        ImageStore.serverFile.attributes.url.attributes.url +\n        \"?imageView2/0\" +\n        store.widthStr +\n        store.heightStr\n      );\n    },\n  }));\n  const bindWidthChange = () => {\n    store.setWidth(ref1.current.value.trim());\n  };\n\n  const bindHeightChange = () => {\n    store.setHeight(ref2.current.value.trim());\n  };\n  return (\n    <Observer>\n      {() => {\n        return (\n          <div>\n            <Spin tip=\"上传中\" spinning={ImageStore.isUploading}>\n              <Dragger {...props}>\n                <UploadIconContainer className=\"ant-upload-drag-icon\">\n                  <InboxOutlined />\n                </UploadIconContainer>\n                <p className=\"ant-upload-text\">点击或拖拽上传图片</p>\n                <p className=\"ant-upload-hint px-2\">\n                  图片仅支持 .png/.gif/.jpg/.jpeg/.svg\n                  图片的格式，且大小不可大于 1M\n                </p>\n              </Dragger>\n            </Spin>\n            {ImageStore.serverFile ? (\n              <Result>\n                <H1>上传结果</H1>\n                <dl>\n                  <dt>线上地址</dt>\n                  <dd>\n                    <a\n                      target=\"_blank\"\n                      href={ImageStore.serverFile.attributes.url.attributes.url}\n                      rel=\"noreferrer noopener\"\n                    >\n                      {ImageStore.serverFile.attributes.url.attributes.url}\n                    </a>\n                  </dd>\n                  <dt>文件名</dt>\n                  <dd>{ImageStore.filename}</dd>\n                  <dt>文件预览</dt>\n                  <dd>\n                    <Image\n                      src={ImageStore.serverFile.attributes.url.attributes.url}\n                      alt=\"\"\n                    />\n                  </dd>\n                  <dt>更多尺寸</dt>\n                  <dd>\n                    <StyledInput\n                      type=\"text\"\n                      onChange={bindWidthChange}\n                      ref={ref1}\n                      placeholder=\"最大宽度（可选）\"\n                    />\n                    <StyledInput\n                      className=\"input2\"\n                      type=\"text\"\n                      onChange={bindHeightChange}\n                      ref={ref2}\n                      placeholder=\"最大高度（可选）\"\n                    />\n                  </dd>\n                  <dd>\n                    <a\n                      target=\"_blank\"\n                      href={store.fullStr}\n                      rel=\"noreferrer noopener\"\n                    >\n                      {store.fullStr}\n                    </a>\n                  </dd>\n                </dl>\n              </Result>\n            ) : null}\n          </div>\n        );\n      }}\n    </Observer>\n  );\n};\n\nexport default Component;\n","import React from \"react\";\nimport { useStores } from \"../stores\";\nimport { observer } from \"mobx-react\";\nimport styled from \"styled-components\";\n\nconst Tips = styled.div`\n  padding: 10px;\n  margin: 30px 0;\n  color: #fff;\n  border-radius: 4px;\n  background-color: #91d5ff;\n`;\n\nconst Component = observer(({ children }) => {\n  const { UserStore } = useStores();\n  return <>{UserStore.currentUser ? null : <Tips>{children}</Tips>}</>;\n});\n\nexport default Component;\n","import React from \"react\";\nimport { observer } from \"mobx-react\";\nimport Uploader from \"../components/Uploader\";\nimport Tips from \"../components/Tips\"\n\nconst Home = observer(() => {\n  return (\n    <>\n      <Tips>请先登录再上传！！！</Tips>\n      <Uploader />\n    </>\n  );\n});\n\nexport default Home;\n"],"sourceRoot":""}