{"version":3,"sources":["components/Footer.js","common/assets/logo.svg","components/Header.js","tools/index.js","components/Loading.js","App.js","index.js","models/index.js","stores/user.js","stores/image.js","stores/history.js","stores/auth.js","stores/index.js"],"names":["Footer","styled","footer","Component","classMap","Logo","img","StyledLink","NavLink","Login","div","StyleButton","observer","history","useHistory","useStores","UserStore","AuthStore","useState","hidden","setHidden","isHidden","xx","window","addEventListener","fn","wait","timer","args","arguments","clearTimeout","setTimeout","apply","debounce","document","documentElement","clientWidth","useEffect","className","onClick","push","src","LogoUrl","alt","id","fill","viewBox","xmlns","fillRule","d","clipRule","to","activeClassName","exact","currentUser","attributes","username","type","logout","console","log","Loading","Home","lazy","History","About","Register","App","Header","fallback","path","component","ReactDOM","render","getElementById","AV","init","appId","appKey","serverURL","Auth","password","user","User","setUsername","setPassword","Promise","resolve","reject","signUp","then","loginedUser","error","logIn","logOut","current","Uploader","file","filename","item","Object","avFile","File","set","save","serverFile","page","limit","query","Query","skip","descending","equalTo","find","results","catch","todo","createWithoutData","destroy","userStore","makeObservable","this","observable","action","pullUser","newFilename","newFile","isUploading","err","message","finally","newList","list","concat","isLoading","append","length","hasMore","success","x","values","resetUser","ImageStore","reset","HistoryStore","b","context","createContext","stores","useContext"],"mappings":"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","file":"static/js/main.08cbff51.chunk.js","sourcesContent":["import React from 'react'\nimport styled from \"styled-components\";\n\nconst Footer = styled.footer`\n  padding: 10px 10px;\n  text-align: center;\n  font-size: 12px;\n  color: #aaa;\n`\nfunction Component() {\n  return (\n    <Footer>\n      <h1>Image Upload</h1>\n    </Footer>\n  )\n}\n\nexport default Component\n","export default __webpack_public_path__ + \"static/media/logo.e711194f.svg\";","import React, { useState, useEffect } from \"react\";\nimport LogoUrl from \"../common/assets/logo.svg\";\nimport { NavLink, useHistory } from \"react-router-dom\";\nimport styled from \"styled-components\";\nimport { Button } from \"antd\";\nimport { useStores } from \"../stores\";\nimport { observer } from \"mobx-react\";\nimport { debounce } from \"../tools/index\";\n\nconst classMap = {\n  header:\n    \"flex flex-wrap flex-row justify-between md:items-center md:space-x-4 bg-white py-6 px-6 relative\",\n  logoLink: \"block\",\n  logoText: \"sr-only\",\n  logoImg: \"h-6 md:h-8\",\n  hamburger: \"inline-block md:hidden w-8 h-8 rounded bg-white text-blue-300 p-1\",\n  nav:\n    \"absolute md:relative top-16 left-0 md:top-0 z-20 md:flex flex-col md:flex-row md:space-x-6 font-semibold w-full md:w-auto bg-white shadow-md rounded-lg md:rounded-none md:shadow-none md:bg-transparent p-6 pt-0 md:p-0\",\n  link: \"block py-1 text-gray-600 hover:underline\",\n  active: \"text-blue-400\",\n};\n\nconst Logo = styled.img``;\n\nconst StyledLink = styled(NavLink)``;\n\nconst Login = styled.div``;\nconst StyleButton = styled(Button)`\n  border-radius: 0.25rem;\n`;\n\nconst Component = observer(() => {\n  const history = useHistory();\n  const { UserStore, AuthStore } = useStores();\n  const [hidden, setHidden] = useState(false);\n\n  const handleLogout = () => {\n    AuthStore.logout();\n    console.log(\"用户注销\");\n    history.push(\"/\");\n  };\n\n  const handleLogin = () => {\n    console.log(\"跳转到登录页面\");\n    isHidden(true);\n    history.push(\"/login\");\n  };\n\n  const handleRegister = () => {\n    console.log(\"跳转到注册页面\");\n    isHidden(true);\n    history.push(\"/register\");\n  };\n\n  const isHidden = (xx) => {\n    if (xx === true) {\n      setHidden(true);\n    } else {\n      setHidden(!hidden);\n    }\n  };\n\n  window.addEventListener(\n    \"resize\",\n    debounce(() => {\n      if (document.documentElement.clientWidth < 768) {\n        isHidden(true);\n      }\n    }, 100)\n  );\n\n  useEffect(() => {\n    isHidden(true);\n  }, []);\n  return (\n    <header className={classMap.header}>\n      <a\n        className={classMap.logoLink}\n        onClick={() => {\n          isHidden(true);\n          history.push(\"/\");\n        }}\n      >\n        <Logo className={classMap.logoImg} src={LogoUrl} alt=\"\" />\n      </a>\n      <button id=\"hamburger\" className={classMap.hamburger} onClick={isHidden}>\n        <svg\n          fill=\"currentColor\"\n          viewBox=\"0 0 20 20\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            fillRule=\"evenodd\"\n            d=\"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z\"\n            clipRule=\"evenodd\"\n          ></path>\n        </svg>\n      </button>\n      <nav className={`${classMap.nav} ${hidden ? \"hidden\" : \"\"}`}>\n        <StyledLink\n          className={classMap.link}\n          to=\"/\"\n          activeClassName={classMap.active}\n          exact\n          onClick={() => {\n            isHidden(true);\n          }}\n        >\n          首页\n        </StyledLink>\n        <StyledLink\n          className={classMap.link}\n          to=\"/history\"\n          activeClassName={classMap.active}\n          onClick={() => {\n            isHidden(true);\n          }}\n        >\n          上传历史\n        </StyledLink>\n        <StyledLink\n          className={classMap.link}\n          to=\"/about\"\n          activeClassName={classMap.active}\n          onClick={() => {\n            isHidden(true);\n          }}\n        >\n          关于我\n        </StyledLink>\n        <Login>\n          {UserStore.currentUser ? (\n            <>\n              <span className=\"mr-1\">\n                {UserStore.currentUser.attributes.username}\n              </span>\n              <StyleButton type=\"primary\" onClick={handleLogout}>\n                注销\n              </StyleButton>\n            </>\n          ) : (\n            <>\n              <StyleButton\n                className=\"mr-1\"\n                type=\"primary\"\n                onClick={handleLogin}\n              >\n                登录\n              </StyleButton>\n              <StyleButton type=\"primary\" onClick={handleRegister}>\n                注册\n              </StyleButton>\n            </>\n          )}\n        </Login>\n      </nav>\n    </header>\n  );\n});\n\nexport default Component;\n","function debounce(fn, wait){\n  let timer = null\n  return function(){\n    let args = arguments\n    clearTimeout(timer)\n    timer = setTimeout(() => {\n      fn.apply(this, args)\n    }, wait)\n  }\n}\n\nexport {\n  debounce\n}","import React from 'react'\n\nfunction Loading() {\n  return (\n    <div>\n      Loading...\n    </div>\n  )\n}\n\nexport default Loading\n","import React, { Suspense, lazy } from \"react\";\nimport \"./App.css\";\nimport { Switch, Route } from \"react-router-dom\";\nimport Footer from \"./components/Footer\";\nimport Header from \"./components/Header\";\nimport Loading from \"./components/Loading\";\n\nconst Home = lazy(() => import(\"./pages/Home\"));\nconst History = lazy(() => import(\"./pages/History\"));\nconst About = lazy(() => import(\"./pages/About\"));\nconst Login = lazy(() => import(\"./pages/Login\"));\nconst Register = lazy(() => import(\"./pages/Register\"));\n\nfunction App() {\n  return (\n    <>\n      <Header />\n      <main className=\"py-6 px-6\">\n        <Suspense fallback={<Loading />}>\n          <Switch>\n            <Route path=\"/\" exact component={Home} />\n            <Route path=\"/history\" exact component={History} />\n            <Route path=\"/about\" exact component={About} />\n            <Route path=\"/login\" exact component={Login} />\n            <Route path=\"/register\" exact component={Register} />\n          </Switch>\n        </Suspense>\n      </main>\n\n      <Footer />\n    </>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport './styles/tailwind.css';\nimport \"antd/dist/antd.less\";\nimport { HashRouter as Router } from \"react-router-dom\";\n\nReactDOM.render(\n  <Router>\n    <App />\n  </Router>,\n  document.getElementById(\"root\")\n);\n","import AV, { User } from \"leancloud-storage\";\n\n// 初始化\nAV.init({\n  appId: \"XlO937XedHKgzxM3pXiJxi2p-gzGzoHsz\",\n  appKey: \"hcHtM6kF4vSwdagKmaaCVe8s\",\n  serverURL: \"https://xlo937xe.lc-cn-n1-shared.com\",\n});\n\nconst Auth = {\n  // 注册\n  register(username, password) {\n    let user = new User();\n    user.setUsername(username);\n    user.setPassword(password);\n    return new Promise((resolve, reject) => {\n      user.signUp().then(\n        (loginedUser) => resolve(loginedUser),\n        (error) => reject(error)\n      );\n    });\n  },\n\n  // 登录\n  login(username, password) {\n    return new Promise((resolve, reject) => {\n      User.logIn(username, password).then(\n        (loginedUser) => resolve(loginedUser),\n        (error) => reject(error)\n      );\n    });\n  },\n\n  // 注销\n  logout() {\n    User.logOut();\n  },\n\n  // 获取当前用户信息\n  getCurrentUser() {\n    return User.current();\n  },\n};\n\nconst Uploader = {\n  // 添加图片\n  add(file, filename) {\n    const item = new AV.Object(\"Image\");\n    const avFile = new AV.File(filename, file);\n    item.set(\"filename\", filename);\n    item.set(\"owner\", AV.User.current());\n    item.set(\"url\", avFile);\n    return new Promise((resolve, reject) => {\n      item.save().then(\n        (serverFile) => resolve(serverFile),\n        (error) => reject(error)\n      );\n    });\n  },\n\n  // 查询对应用户的图片\n  find({ page = 0, limit = 10 }) {\n    const query = new AV.Query(\"Image\");\n    // query.include(\"owner\");\n    query.limit(limit);\n    query.skip(page * limit);\n    query.descending(\"createdAt\");\n    query.equalTo(\"owner\", AV.User.current());\n    return new Promise((resolve, reject) => {\n      query\n        .find()\n        .then((results) => resolve(results))\n        .catch((error) => reject(error));\n    });\n  },\n\n  // 删除某一张图片\n  deleteItem(id) {\n    const todo = AV.Object.createWithoutData(\"Image\", id);\n    return new Promise((resolve, reject) => {\n      todo\n        .destroy()\n        .then((results) => resolve(results))\n        .catch((error) => reject(error));\n    });\n  },\n};\n\nexport { Auth, Uploader };\n","import { observable, action, makeObservable } from \"mobx\";\nimport { Auth } from \"../models\";\n\nclass UserStore {\n  constructor() {\n    makeObservable(this);\n  }\n  @observable currentUser = null;\n\n  @action pullUser() {\n    this.currentUser = Auth.getCurrentUser();\n  }\n\n  @action resetUser() {\n    this.currentUser = null;\n  }\n}\n\nconst userStore = new UserStore()\n\nuserStore.pullUser()\n\nexport default userStore;\n","import { observable, action, makeObservable } from \"mobx\";\nimport { Uploader } from \"../models\";\nimport { message } from \"antd\";\n\nclass ImageStore {\n  constructor() {\n    makeObservable(this);\n  }\n  @observable filename = \"\";\n  @observable file = null;\n  @observable serverFile = null;\n  @observable isUploading = false;\n  @action setFilename(newFilename) {\n    this.filename = newFilename;\n  }\n  @action setFile(newFile) {\n    this.file = newFile;\n  }\n  @action upload() {\n    this.isUploading = true;\n    this.serverFile = null;\n    return new Promise((resolve, reject) => {\n      Uploader.add(this.file, this.filename)\n        .then((serverFile) => {\n          this.serverFile = serverFile;\n          resolve(serverFile);\n        })\n        .catch((err) => {\n          message.error(\"上传失败\");\n          reject(err);\n        })\n        .finally(() => (this.isUploading = false));\n    });\n  }\n\n  @action reset() {\n    this.isUploading = false;\n    this.serverFile = null;\n  }\n}\n\nexport default new ImageStore();\n","import { observable, action, makeObservable } from \"mobx\";\nimport { Uploader } from \"../models\";\nimport { message } from \"antd\";\n\nclass HistoryStore {\n  constructor() {\n    makeObservable(this);\n  }\n  @observable list = [];\n  @observable isLoading = false;\n  @observable hasMore = true;\n  @observable page = 0;\n  limit = 10;\n\n  @action append(newList) {\n    this.list = this.list.concat(newList);\n  }\n\n  @action find() {\n    this.isLoading = true;\n    // console.log('find...')\n    Uploader.find({ page: this.page, limit: this.limit })\n      .then((newList) => {\n        this.append(newList);\n        this.page++;\n        if (newList.length < this.limit) {\n          this.hasMore = false;\n        }\n      })\n      .catch((error) => {\n        message.error(\"加载数据失败\", error);\n      })\n      .finally(() => {\n        this.isLoading = false;\n      });\n  }\n\n  @action reset() {\n    this.list = [];\n    this.isLoading = false;\n    this.hasMore = true;\n    this.page = 0;\n  }\n\n  @action delete(id) {\n    return new Promise((resolve,reject)=>{\n      Uploader.deleteItem(id)\n        .then((results)=>{\n          message.success('图片删除成功')\n          resolve(results)\n        })\n        .catch(error => message.error('删除元素失败'))\n    })\n  }\n}\n\nexport default new HistoryStore();\n","import { makeObservable, observable, action } from \"mobx\";\nimport {Auth} from '../models'\nimport UserStore from './user'\nimport ImageStore from './image'\nimport HistoryStore from \"./history\"\nimport {message} from \"antd\"\n\nwindow.x = UserStore\n\nclass AuthStore {\n  constructor() {\n    makeObservable(this);\n  }\n  @observable values = {\n    username: \"\",\n    password: \"\",\n  };\n\n  @action setUsername(username) {\n    this.values.username = username;\n  }\n\n  @action setPassword(password) {\n    this.values.password = password;\n  }\n\n  // 登录\n  @action login() {\n    console.log(\"登录中...\");\n    const {username,password} = this.values\n    return new Promise((resolve,reject)=>{\n      Auth.login(username,password).then(user=>{\n        message.success('登录成功')\n        UserStore.pullUser()\n        resolve(user)\n      }).catch(err=>{\n        message.error('登录失败')\n        UserStore.resetUser()\n        reject(err)\n      })\n    })\n  }\n\n  @action logout() {\n    message.success(\"注销成功\");\n    Auth.logout()\n    ImageStore.reset()\n    UserStore.resetUser()\n    HistoryStore.reset()\n\n  }\n\n  @action register() {\n    console.log(\"注册中...\");\n    const {username,password} = this.values\n    return new Promise((resolve,reject)=>{\n      Auth.register(username,password).then(user=>{\n        message.success('注册成功')\n        UserStore.pullUser()\n        resolve(user)\n      }).catch(err=>{\n        message.error('注册失败')\n        UserStore.resetUser()\n        reject(err)\n      })\n    })\n  }\n}\n\nexport default new AuthStore()","import {createContext, useContext} from 'react'\nimport AuthStore from './auth.js'\nimport UserStore from './user.js'\nimport ImageStore from './image.js'\nimport HistoryStore from './history.js'\n\nwindow.b = UserStore\n\nconst context = createContext({\n  AuthStore,\n  UserStore,\n  ImageStore,\n  HistoryStore\n})\n\nwindow.stores = {\n  AuthStore,\n  UserStore,\n  ImageStore,\n  HistoryStore\n}\n\nexport const useStores = () => useContext(context) "],"sourceRoot":""}